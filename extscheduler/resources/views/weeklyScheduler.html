<br/>
<div id="launch-link"></div>
<br/>
<h3>Resources</h3>
<div id="resources-qwp"></div>
<br/>
<h3>My Events</h3>
<div id="events-radiogroup"></div>
<div id="events-qwp"></div>

<style>
    #launch-link a.launch-button {
        background-color: #eeeeee;
        border-radius: 5px;
        border: solid #c0c0c0 1px;
        padding: 5px;
        font-size: 14px;
        font-weight: bold;
    }
    #launch-link a.launch-button:hover {
        background-color: #c0c0c0;
    }
</style>

<script type="text/javascript">
    Ext4.onReady(function()
    {
        // verify that the module property ExtSchedulerUserGroupName has been configured
        var userGroupName = LABKEY.getModuleContext('extscheduler').ExtSchedulerUserGroupName;
        if (userGroupName == null)
        {
            var configureLink = LABKEY.ActionURL.buildURL('admin', 'moduleProperties', null, {tabId: 'props'});
            var msg = '<span class="labkey-error">ExtSchedulerUserGroupName has not been configured for this folder.</span> ';
            if (LABKEY.user.isAdmin)
                msg += LABKEY.Utils.textLink({text: 'Configure', href: configureLink});
            Ext4.get('launch-link').update(msg);
        }
        else
        {
            var schedulerAppLink = LABKEY.ActionURL.buildURL('extscheduler', 'weeklyTest', null, {
                returnUrl: window.location.pathname + window.location.search
            });
            Ext4.get('launch-link').update('<a class="launch-button" href="' + schedulerAppLink + '">Launch Scheduler</a>');
        }

        new LABKEY.QueryWebPart({
            renderTo: 'resources-qwp',
            frame: 'none',
            schemaName: 'extscheduler',
            queryName: 'Resources',
            columns: 'Name,color',
            sort: 'Name'
        });

        var timeFrameFilter = null;
        var renderEventsQueryWebPart = function()
        {


            new LABKEY.QueryWebPart({
                renderTo: 'events-qwp',
                frame: 'none',
                schemaName: 'extscheduler',
                queryName: 'Events',
                columns: 'resouceId,Name,StartDate,EndDate,Alias,Comments,project,location',
                filterArray: [LABKEY.Filter.create('StartDate', new Date(), LABKEY.Filter.Types.DATE_GREATER_THAN_OR_EQUAL)],
                sort: 'StartDate,ResourceId,Name'
            });
        };



        renderEventsQueryWebPart();
    });
</script>